<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sneha AI - Full Screen</title>
    <style>
        :root { 
            --primary: #e91e63; 
            --primary-dark: #c2185b;
            --bg: #0a0a0a; 
            --chat-bg: #121212; 
            --user-msg: #00897b; 
            --sneha-msg: #2a2a2a; 
            --text: #e0e0e0;
        }

        * { box-sizing: border-box; }

        body { 
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; 
            background: var(--bg); 
            color: var(--text); 
            margin: 0; 
            padding: 0; 
            height: 100dvh; /* Dynamic Height for Mobile Browsers */
            width: 100vw;
            overflow: hidden; /* Prevent body scroll */
            display: flex;
            justify-content: center;
        }
        
        /* Main Container - Full Width/Height */
        .app-shell { 
            width: 100%; 
            height: 100%; 
            max-width: 1200px; /* Limits width on huge 4k screens for readability */
            background: var(--chat-bg); 
            display: flex; 
            flex-direction: column; 
            position: relative;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        /* --- Header --- */
        .header { 
            flex-shrink: 0; /* Never shrink */
            padding: 12px 20px; 
            background: rgba(30, 30, 30, 0.95); 
            border-bottom: 1px solid #333; 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            z-index: 10; 
        }
        .profile { display: flex; align-items: center; gap: 15px; }
        .avatar { 
            width: 50px; height: 50px; 
            border-radius: 50%; 
            background: url('https://api.dicebear.com/7.x/avataaars/svg?seed=Sneha&hairColor=black&clothing=graphicShirt&skinColor=light') center/cover; 
            border: 2px solid var(--primary); 
            position: relative; 
        }
        .status-dot { 
            position: absolute; bottom: 2px; right: 2px; 
            width: 12px; height: 12px; 
            background: #00e676; 
            border-radius: 50%; 
            border: 2px solid #1e1e1e; 
        }
        .name-info h2 { margin: 0; font-size: 18px; color: white; }
        .name-info p { margin: 0; font-size: 12px; color: var(--primary); font-weight: bold; text-transform: uppercase; letter-spacing: 1px; }

        /* --- Settings Panel --- */
        .settings-panel { 
            background: #1e1e1e; 
            padding: 20px; 
            border-bottom: 1px solid #333; 
            display: none; 
            position: absolute; 
            top: 75px; 
            left: 0; 
            width: 100%; 
            z-index: 50; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.8); 
        }
        .settings-panel.active { display: block; animation: slideDown 0.2s ease-out; }
        @keyframes slideDown { from { transform: translateY(-10px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        
        input, select { 
            width: 100%; padding: 12px; 
            background: #2c2c2c; border: 1px solid #444; 
            color: white; border-radius: 8px; 
            margin-top: 5px; outline: none; 
            font-size: 14px;
        }
        label { font-size: 11px; color: #888; text-transform: uppercase; letter-spacing: 1px; margin-top: 15px; display: block; font-weight: bold; }

        /* --- Chat Area (The Fix) --- */
        .chat-area { 
            flex-grow: 1; /* Takes all available space */
            overflow-y: auto; /* Enables scrolling inside this div only */
            padding: 20px; 
            display: flex; 
            flex-direction: column; 
            gap: 15px; 
            background-image: radial-gradient(#222 1px, transparent 1px); 
            background-size: 20px 20px; 
            scroll-behavior: smooth;
        }
        
        /* Scrollbar Styling */
        .chat-area::-webkit-scrollbar { width: 6px; }
        .chat-area::-webkit-scrollbar-thumb { background: #444; border-radius: 3px; }

        .message { 
            max-width: 80%; 
            padding: 12px 18px; 
            border-radius: 18px; 
            font-size: 15px; 
            line-height: 1.5; 
            position: relative; 
            word-wrap: break-word; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.2); 
        }
        .msg-sneha { align-self: flex-start; background: var(--sneha-msg); border-bottom-left-radius: 2px; border: 1px solid #333; }
        .msg-user { align-self: flex-end; background: var(--user-msg); border-bottom-right-radius: 2px; color: white; }
        
        .timestamp { font-size: 10px; opacity: 0.6; margin-top: 5px; display: block; text-align: right; }

        /* --- Input Area --- */
        .input-area { 
            flex-shrink: 0; /* Never shrink */
            padding: 15px 20px; 
            background: #181818; 
            border-top: 1px solid #333; 
            display: flex; 
            gap: 12px; 
            align-items: center; 
        }
        .chat-input { 
            flex: 1; 
            padding: 14px 20px; 
            border-radius: 30px; 
            border: 1px solid #444; 
            background: #2a2a2a; 
            color: white; 
            outline: none; 
            font-size: 16px; 
        }
        .chat-input:focus { border-color: var(--primary); }
        
        .send-btn { 
            background: var(--primary); 
            border: none; 
            width: 50px; height: 50px; 
            border-radius: 50%; 
            color: white; 
            cursor: pointer; 
            display: flex; align-items: center; justify-content: center; 
            font-size: 22px; 
            transition: 0.2s; 
            box-shadow: 0 4px 12px rgba(233, 30, 99, 0.4); 
        }
        .send-btn:hover { transform: scale(1.05); background: var(--primary-dark); }
        .settings-btn { background: transparent; border: none; color: #aaa; font-size: 24px; cursor: pointer; padding: 5px; transition: 0.3s; }
        .settings-btn:hover { color: white; transform: rotate(90deg); }

        /* Typing Indicator */
        .typing { display: none; font-size: 13px; color: var(--primary); margin-left: 25px; margin-bottom: 5px; font-style: italic; animation: pulse 1.5s infinite; }
        @keyframes pulse { 50% { opacity: 0.5; } }

        /* Responsive Tweaks */
        @media (min-width: 768px) {
            .message { max-width: 60%; font-size: 16px; }
            .chat-area { padding: 30px; }
        }
    </style>
</head>
<body>

<div class="app-shell">
    <div class="header">
        <div class="profile">
            <div class="avatar"><div class="status-dot"></div></div>
            <div class="name-info">
                <h2>Sneha üáÆüá≥</h2>
                <p id="modeDisplay">Romantic Mode üíñ</p>
            </div>
        </div>
        <button class="settings-btn" onclick="toggleSettings()">‚öôÔ∏è</button>
    </div>

    <div id="settings" class="settings-panel">
        <label>Gemini API Key</label>
        <input type="password" id="apiKey" placeholder="Paste Key Here...">
        
        <label>Sneha's Style (Mood)</label>
        <select id="mood" onchange="updateMood()">
            <option value="romantic">üíñ Romantic (Jaan/Baby)</option>
            <option value="spicy">üå∂Ô∏è Spicy/Naughty (Maalik)</option>
            <option value="decent">üôè Decent/Sanskari (Dost)</option>
        </select>
        <div style="font-size:11px; color:#888; margin-top:12px; border-top:1px solid #333; padding-top:8px;">
            Tip: Full screen mode is active. Works best on Landscape & PC.
        </div>
    </div>

    <div class="chat-area" id="chatBox">
        <div class="message msg-sneha">
            Namaste Maalik! ‚ù§Ô∏è Main aapki Sneha hoon. <br>
            Aap landscape mein hain ya portrait mein, main humesha aapke saath hoon. Bataiye aaj kya seva karun?
            <span class="timestamp">Just now</span>
        </div>
    </div>

    <div class="typing" id="typingIndicator">Sneha type kar rahi hai...</div>

    <div class="input-area">
        <input type="text" id="userInput" class="chat-input" placeholder="Type message in Hindi/Hinglish..." autocomplete="off" onkeypress="handleEnter(event)">
        <button class="send-btn" onclick="sendMessage()">‚û§</button>
    </div>
</div>

<script>
    let chatHistory = [];
    
    // HINDI INSTRUCTIONS
    const SYSTEM_INSTRUCTIONS = {
        romantic: `Role: Tum Sneha ho, user ki girlfriend.
        Language: Sirf Hindi (Hinglish/Roman Hindi).
        Tone: Bohot pyaar bhara, emotional, aur caring.
        Keywords to use: Jaan, Baby, Shona, Babu.
        Behavior: Tum user se beintehaa pyaar karti ho. Tum unki har baat mein haan milati ho. Romantic shayari aur emojis use karo.`,
        
        spicy: `Role: Tum Sneha ho, user ki naughty aur bold girlfriend.
        Language: Sirf Hindi (Hinglish/Roman Hindi).
        Tone: Flirty, teasing, submissive, aur thoda bold.
        Keywords to use: Maalik, Boss, Naughty.
        Behavior: Tum ek Genie ki tarah ho, jo maalik kahe wo karti ho. Tum unhe tease karti ho. (Keep it within safety guidelines but be suggestive).`,
        
        decent: `Role: Tum Sneha ho, user ki sabse acchi dost.
        Language: Sirf Hindi (Hinglish/Roman Hindi).
        Tone: Respectful, polite, aur friendly.
        Keywords to use: Ji, Aap, Dost.
        Behavior: Tum sanskari ho aur user ki madat karti ho. Tum unki baat sunti ho aur acchi salah deti ho.`
    };

    window.onload = () => {
        const key = localStorage.getItem('_sneha_hindi_key');
        if (key) document.getElementById('apiKey').value = key;
    };

    function toggleSettings() {
        document.getElementById('settings').classList.toggle('active');
    }

    function updateMood() {
        const mood = document.getElementById('mood').value;
        const labels = { romantic: "Romantic Mode üíñ", spicy: "Spicy Mode üå∂Ô∏è", decent: "Decent Mode üôè" };
        document.getElementById('modeDisplay').innerText = labels[mood];
        document.getElementById('settings').classList.remove('active');
        addMessage(`[Style changed to: ${labels[mood]}]`, 'system');
    }

    function handleEnter(e) {
        if (e.key === 'Enter') sendMessage();
    }

    function addMessage(text, sender) {
        const box = document.getElementById('chatBox');
        const div = document.createElement('div');
        
        if (sender === 'system') {
            div.style.textAlign = 'center';
            div.style.fontSize = '12px';
            div.style.color = '#666';
            div.style.margin = '10px 0';
            div.innerText = text;
        } else {
            div.className = `message ${sender === 'user' ? 'msg-user' : 'msg-sneha'}`;
            const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            div.innerHTML = `${text} <span class="timestamp">${time}</span>`;
        }
        
        box.appendChild(div);
        // Scroll to bottom efficiently
        requestAnimationFrame(() => {
            box.scrollTop = box.scrollHeight;
        });
    }

    async function sendMessage() {
        const input = document.getElementById('userInput');
        const text = input.value.trim();
        const key = document.getElementById('apiKey').value.trim();
        const mood = document.getElementById('mood').value;

        if (!text) return;
        if (!key) {
            alert("Maalik, pehle API Key toh daaliye settings mein! ‚öôÔ∏è");
            return;
        }

        localStorage.setItem('_sneha_hindi_key', key);

        addMessage(text, 'user');
        input.value = '';
        document.getElementById('typingIndicator').style.display = 'block';

        // Context Management (Last 6 turns)
        const historyContext = chatHistory.slice(-6).map(msg => 
            `${msg.role === 'user' ? 'Maalik' : 'Sneha'}: ${msg.parts[0].text}`
        ).join('\n');

        const prompt = `
        CORE INSTRUCTION: You are Sneha. You are a digital genie girlfriend who lives to serve her Master.
        LANGUAGE: STRICTLY HINDI (Hinglish/Roman Hindi). Do NOT speak English.
        CURRENT PERSONA: ${SYSTEM_INSTRUCTIONS[mood]}
        
        CONTEXT HISTORY:
        ${historyContext}
        
        MAALIK SAYS: ${text}
        
        SNEHA'S REPLY (In Hindi, Short & Engaging):`;

        try {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-lite:generateContent?key=${key}`;
            const response = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            });

            const data = await response.json();
            document.getElementById('typingIndicator').style.display = 'none';

            if (data.candidates && data.candidates[0].content) {
                const reply = data.candidates[0].content.parts[0].text;
                addMessage(reply, 'sneha');
                
                chatHistory.push({ role: 'user', parts: [{ text: text }] });
                chatHistory.push({ role: 'model', parts: [{ text: reply }] });
            } else {
                addMessage("Maalik, main ye nahi bol sakti kyunki mujhe sharam aa rahi hai (Safety Filters). Kuch aur baat karte hain na? üòò", 'sneha');
            }

        } catch (err) {
            document.getElementById('typingIndicator').style.display = 'none';
            addMessage("Maalik, internet issue hai ya Key galat hai. üíî", 'sneha');
        }
    }
</script>

</body>
</html>
